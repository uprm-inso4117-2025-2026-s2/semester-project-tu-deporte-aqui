
==== 2.1.6 Function Signatures (Pseudocode at the moment, Not Event-Tied)

These signatures describe what information is needed to perform key actions in *Tu Deporte AquÃ­* and what state is produced or changed. The design is intentionally modular so it can be extended later without committing to a specific architecture since we don't have one decided yet.

===== Core Records (state holders)

* SourceRegistry: configured sources and basic health metadata
* RawArchive: stored raw snapshots from sources (for traceability)
* UpdateStore: stored normalized updates with provenance
* CanonicalStore: current best-known state (games, standings, athlete updates)
* ConflictQueue: unresolved conflicts that need resolution
* StatusBoard: user-facing status and reliability messages

===== Source Configuration

registerSource(SourceRegistry, SourceConfig) -> SourceRegistry

updateSourceConfig(SourceRegistry, SourceId, SourceConfig) -> SourceRegistry

removeSource(SourceRegistry, SourceId) -> SourceRegistry

listSources(SourceRegistry) -> List<SourceConfig>

===== Fetching and Snapshot Storage

fetchSnapshot(SourceRegistry, SourceId, FetchOptions) -> (SourceRegistry, Snapshot or FetchError)

storeSnapshot(RawArchive, Snapshot) -> (RawArchive, SnapshotId)

getSnapshot(RawArchive, SnapshotId) -> Snapshot or None

===== Parsing and Normalization

normalizeSnapshot(Snapshot, ParseOptions) -> (List<NormalizedUpdate>, Diagnostics)

storeUpdates(UpdateStore, List<NormalizedUpdate>) -> (UpdateStore, List<UpdateId>)

getUpdate(UpdateStore, UpdateId) -> NormalizedUpdate or None

===== Canonical Merge (best-known current state)

applyUpdate(CanonicalStore, NormalizedUpdate, MergePolicy) -> (CanonicalStore, Conflict or None, Diagnostics)

applyUpdateBatch(CanonicalStore, List<NormalizedUpdate>, MergePolicy) -> (CanonicalStore, List<Conflict>, Diagnostics)

getCanonical(CanonicalStore, EntityKey) -> CanonicalEntity or None

storeCanonical(CanonicalStore, CanonicalEntity) -> CanonicalStore

===== Conflict Handling

enqueueConflicts(ConflictQueue, List<Conflict>) -> ConflictQueue

listConflicts(ConflictQueue) -> List<Conflict>

resolveConflictAuto(ConflictQueue, CanonicalStore, ConflictId, MergePolicy)
  -> (ConflictQueue, CanonicalStore, CanonicalEntity or ResolveError, Diagnostics)

resolveConflictManual(ConflictQueue, CanonicalStore, ConflictId, ResolutionDecision)
  -> (ConflictQueue, CanonicalStore, CanonicalEntity)

===== Reliability Indicators and Degraded Messaging

computeReliability(CanonicalStore, UpdateStore, EntityKey, ReliabilityPolicy)
  -> (ReliabilityIndicator, Diagnostics)

setSystemStatus(StatusBoard, SystemStatus) -> StatusBoard

annotateEntityStatus(StatusBoard, EntityKey, ReliabilityIndicator) -> StatusBoard

buildPublicView(CanonicalStore, StatusBoard, EntityKey) -> PublicView or None

===== User-Facing Queries

getGame(CanonicalStore, GameId) -> GameView or None

getStandings(CanonicalStore, StandingsKey) -> StandingsView or None

getAthleteUpdates(CanonicalStore, AthleteId) -> List<AthleteUpdateView>

searchCanonical(CanonicalStore, SearchQuery) -> List<PublicView>

===== Maintenance and Extensibility Hooks

recomputeAllReliability(CanonicalStore, UpdateStore, StatusBoard, ReliabilityPolicy)
  -> (StatusBoard, Diagnostics)

rebuildCanonicalFromUpdates(CanonicalStore, UpdateStore, MergePolicy)
  -> (CanonicalStore, Diagnostics)
